<!--
####################################### Bubble Sort_Element ##################################################
#  Question     : Given a random array of size arr_size , and some element X highlighted
#                 Everthing to the right of X is sorted(and bigger), and everything to the right is constrained random.
#		  Highlighted element needs to be placed in right place by Bubble Sort
#  Variables    : arr_size 0 - 12
#  Chapter      : InsetionSort
#  Author       : Gayathri
#  Date         : July 20, 2012
#######################################################################################################
-->

<!DOCTYPE html>
<html data-require="math">

	<head>
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <title>Sorting using Bubble Sort</title>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
                <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
                <script src="../JSAV/lib/jquery.transform.light.js"></script>
                <script src="../JSAV/lib/raphael.js"></script>
                <script type="text/javascript"
       src="http://cdn.mathjax.org/mathjax/1.1-latest/MathJax.js?config=http://algoviz.org/OpenDSA/dev/OpenDSA/ODSAkhan-exercises/KAthJax-77111459c7d82564a705f9c5480e2c88.js">
                </script>
                <script>urlBaseOverride = "../ODSAkhan-exercises/";</script>
                <script src="../ODSAkhan-exercises/khan-exercise.js"></script>
                <script src="../JSAV/build/JSAV-min.js"></script>
                <link rel="stylesheet" href="../JSAV/css/JSAV.css" type="text/css" />

		<style>
			.jsavcontainer {
  			border: 0px;
			}
		</style>


	<body>

	<script>
  		var jsav, arr , arr_clone, myGuess, spos, nsel, sel1 ;
  	
		// function to handle a click event on an array
  		var clickHandler = function(index, e) {
			var sublist;
			sublist =0;
			if ( index <= spos)
				sublist = 1;
			if ( sublist == 1 )
			{
				if (nsel === 0) 
				{ // if first click
        				arr.css(index, {"font-size": "130%"});
					nsel = nsel + 1;
					sel1 = index;
				}
    				else {
					arr.swap(sel1,index);
					arr.unhighlight(sel1);
					arr.unhighlight(index);
					arr.highlight(spos);
					arr.css(index, {"font-size": "100%"});
					arr.css(sel1, {"font-size": "100%"});
					nsel = 0;
				}
					
    			}
			myGuess = 1;
  		}

		// function that initialise JSAV library 
  		initJSAV = function(a, sort_pos) {
			var i;
			var j;
			myGuess = -1;
			spos = sort_pos;
			nsel = 0;
    			jsav = new JSAV("jsav");
    			arr = jsav.ds.array(JSAV.utils.rand.numKeys(0, 999, a),{indexed: true, center: false});
			arr.show();
			arr.hide();
			for (i=0; i<(a-sort_pos-1); i++) {
				for (j=0; j<=(a-i-2);j++) {
					if (arr.value(j) > arr.value(j+1) ) 
						arr.swap(j,j+1);
				}
			}
			arr.highlight(sort_pos);
			arr.show();
			arr_clone = jsav.ds.array(JSAV.utils.rand.numKeys(0, 999, a));
                        arr_clone.hide();
                        for (i=0; i<a; i++)
                        {
                                arr_clone.value(i,arr.value(i));
                        }
			// bind the clickHandler to handle click events on the array
			arr.click(clickHandler);
  		}
	

 		// function that validates student's answer 
 		function checkAnswer (a, sort_pos) {
  			var i;
			var j=0;
			var temp;
                                for (j=0; j < sort_pos;j++) {
                                        if (arr_clone.value(j) > arr_clone.value(j+1) ){
                                                arr_clone.swap(j,j+1);
                                }
                        }
			// Return false if user has highlighted any position before start_pos
			for (i=0; i < a; i++) {
				if ( arr.value(i) != arr_clone.value(i)) return (2 === 1);
			}
			// All conditions passed, return true
  			return ( 1 === 1);
  		} 


	</script>


	<div class="exercise">
  		<div class="vars">
    			<var id="arr_size">randRange( 6, 12 )</var>
			<var id="sort_pos">randRange(1,arr_size-1)</var>
    			<var id="JSAV">initJSAV(arr_size,sort_pos)</var>
		</div>

  		<div class="problems">
    			<div>
				<p class="problem"> In the array of size <var>arr_size</var>  displayed below , element at position <var>sort_pos</var> is highlighted. The array represents an intermediate state in bubble sort with all elements to its right sorted (and are bigger) </p>
      				<div class="question">
				<p> In this array, the highlighted element is the current element to be processed in the next pass of Bubble Sort. Show the array after the element has been placed in its proper position (and other elements moved as necessary). </p>
				<div id="jsav"></div>
      			</div>
      			<div class="solution" data-type="custom">
				<div class="guess">
          				[myGuess]
        			</div>
				<div class="validator-function">
	  				return checkAnswer (arr_size,sort_pos);
				</div>
      			</div>
     
		 	<div class="hints">
				<p> Determine the element which should appear at the index <var>sort_pos</var> using bubble sort </p>
      			</div>
    		</div>
  	</div>
</body>
</html>
