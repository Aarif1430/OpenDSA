<!--
####################################### Quick Sort Partition ##################################################
#  Question     : Given a random array of size arr_size and the pivot element highlighted partition the array using quciksort
#  Variables    : arr_size 6 - 12
#  Chapter      : QuickSort
#  Author       : Gayathri
#  Date         : July 31, 2012
#######################################################################################################
-->

<!DOCTYPE html>
<html data-require="math">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Partition Array</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
  <script src="../../JSAV/lib/jquery.transform.light.js"></script>
  <script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/1.1-latest/MathJax.js?config=http://algoviz.org/OpenDSA/dev/OpenDSA/ODSAkhan-exercises/KAthJax-77111459c7d82564a705f9c5480e2c88.js">
  </script>
  <script>urlBaseOverride = "../../ODSAkhan-exercises/";</script>
  <script src="../../ODSAkhan-exercises/khan-exercise.js"></script>
  <script src="../../JSAV/build/JSAV-min.js"></script>
  <link rel="stylesheet" href="../../JSAV/css/JSAV.css" type="text/css" />

  <style>
    .jsavcontainer {
      border: 0px;
      width: 100%;
    }
  </style>
<head>

<body>

  <script>
    var jsav, arr, arr_clone, pivotIndex, selIndex, myGuess;

    // function to handle a click event on an array
    var clickHandler = function (index, e) {
      var sublist;
      sublist = 0;
      if (selIndex === -1) { // if first click
        arr.css(index, {"font-size": "130%"});
        selIndex = index;
      } else {
        arr.swap(selIndex, index);
        arr.css(index, {"font-size": "100%"});
        arr.css(selIndex, {"font-size": "100%"});
        selIndex = -1;
      }

      myGuess = 1;
    }

    // function that initialise JSAV library
    initJSAV = function (length) {
      selIndex = -1;
      myGuess = -1;
      pivotIndex = Math.floor(length / 2);
      jsav = new JSAV("jsav");
      jsav.recorded();
      arr = jsav.ds.array(JSAV.utils.rand.numKeys(0, 999, length), {indexed: true, center: false});
      arr_clone = arr.clone();
      
      // bind the clickHandler to handle click events on the array
      arr.click(clickHandler);
      
      arr.highlight(pivotIndex);
    }


    // function that validates student's answer
    function checkAnswer(length) {
      var left = -1;
      var right = length - 1;
      var pivotVal = arr_clone.value(pivotIndex);
      
      // Move the pivot to the end
      arr_clone.swap(pivotIndex, length - 1);
      
      while (left < right) {
        // Move bounds inward until they meet
        while (arr_clone.value(++left) < pivotVal) { }
        while ((right > 0) && (arr_clone.value(--right) > pivotVal)) { }

        // Stop when all elements have been appropriately swapped
        if (left >= right) {
          break;
        }

        // Highlight elements to swap
        arr_clone.swap(left, right);
      }
      
      // Move the pivot to its final location
      arr_clone.swap(left, length - 1);

      for (var i = 0; i < length; i++){
        if (arr.value(i) !== arr_clone.value(i)) {
          return false;
        }
      }
      return true;
    }
  </script>


  <div class="exercise">
    <div class="vars">
      <var id="arr_size">randRange( 6, 12 )</var>
      <var id="JSAV">initJSAV(arr_size)</var>
    </div>
    <div class="problems">
      <div>
        <div class="question">
          <p>The pivot element for quicksort is highlighted in the array below. Partition the array using quicksort.</p>
          <div id="jsav"></div>
        </div>
        <div class="solution" data-type="custom">
          <div class="guess">
            [myGuess]
          </div>
          <div class="validator-function">
            return checkAnswer (arr_size);
          </div>
        </div>
        <div class="hints">
          <p>Partition step moves pivot element to its index at the sorted array</p>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
