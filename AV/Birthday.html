<!DOCTYPE html>
<!-- Simple activity to calculate the probability of collisions for a
     given number of values in a table of a given size.
     Written by Cliff Shaffer, August 2011.
     Revised for HTML validation and reformatting, June 2012.
     For more information, see http://algoviz.org/OpenDSA
-->

<html>
<head>
<meta charset="utf-8">
<title>Birthday Problem Calculator</title>
<link href="opendsaAV.css" title="CSS" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="../JSAV/css/JSAV.css" type="text/css" />

<style type="text/css">
#container {
  width: 520px;
  height: 150px;
  border: 1px solid black;
  background-color: #efe;
  overflow: hidden;
}

p.instructions {
  text-align:center;
  margin: 0px;
}

p.output {
  text-align:center;
  margin: 0px;
  margin-top: -15px;
}
</style>
</head>

<body>
<div id="container">
<table id="tableT">
  <tr>
    <td>
      <p class="instructions">
        Calculate the probability of a collision.<br/>
        Formula Used: \(1 - \frac{t!}{(t-n)! * (t^n)}\)<br/>
        where t is the table size
        and n is the number of records inserted.
      </p>
    </td>
    <td style="text-align: right; vertical-align: top">
      <input type="button" name="about" value="About" >
    </td>
  </tr>
  <tr>
    <td colspan="2">
      <p>
        <label>&nbsp;Table size:&nbsp;</label>
        <input name="tablesize" type="number" value="365"/>
        <label>&nbsp;# of records&nbsp;</label>
        <input name="numrecs" type="number" value="5"/>&nbsp;
        <input type="button" name="calculate" value="Calculate" />
      </p>
    </td>
  </tr>
  <tr>
    <td colspan="2">
      <p class="output" ></p>
    </td>
  </tr>
</table>
</div>

<!-- SCRIPT SECTION -->

<script
   src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js">
</script>

<script src="../JSAV/build/JSAV-min.js"></script>
<script type="text/javascript"
	src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script>
(function($) {
  // Convenience function for writing output messages
  var Tell = function(msg) { $('p[class="output"]').text(msg); };

  // Action callbacks for form entities
  $('input[name="about"]').click(About);
  $('input[name="tablesize"]').focusout(CheckTable);
  $('input[name="numrecs"]').focusout(CheckRecs);
  $('input[name="calculate"]').click(Calculate);

  // Declare and initialize state variables
  var TSize = Number($('input[name="tablesize"]').val()); // Table size
  var Recs = Number($('input[name="numrecs"]').val()); // Number of records

  // Process About button: Pop up a message with an Alert
  function About() {
    alert("Birthday problem calculator\nWritten by Cliff Shaffer\nCreated as part of the OpenDSA hypertextbook project\nFor more information, see http://algoviz.org/OpenDSA\nSource and development history available at https://github.com/cashaffer/OpenDSA\nCompiled with JSAV library version " + JSAV.version());
  }

  // Validate Table size field
  function CheckTable() {
    TSize = Number($('input[name="tablesize"]').val());
    if (isNaN(TSize) || (TSize < 1) || (TSize > 10000)) {
      alert("Table size has to be a positive number less than 10000");
    }
  }

  // Validate number of records field
  function CheckRecs() {
    Recs = Number($('input[name="numrecs"]').val());
    if (isNaN(Recs) || (Recs < 1) || (Recs > TSize)) {
      alert("Number of records must be a positive number less than the table size");
    }
  }

  // Main action: Result of clicking "Calculate" button
  function Calculate() {
    var prob,
        fact;
    if (TSize <= 0 || Recs < 0) { Tell("Bad input"); }
    else {
      if (Recs === 0) { prob = 0.0; }
      else if (Recs > TSize) { prob = 1.0; }
      else {
        fact = 1.0;
        for (var i = TSize - Recs + 1; i < TSize; i++)
          fact = fact * i/TSize;
        prob = 1.0 - fact;
      }
      Tell(prob*100 + "%");
    }
  }
})(jQuery);
</script>

</body>
</html>
